<!DOCTYPE html>
<html>
<head>
<title>Struts2</title>
<!-- 2017-10-20 Fri 11:11 -->
<meta  charset="utf-8">
<meta  name="generator" content="Org-mode">
<meta  name="author" content="imfine">
<meta  name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="assets/base.css">
<script src="assets/base.js"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="index.html"> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="content">
<h1 class="title">Struts2</h1>
<nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. 序</a></li>
</ul>
</div>
</nav>


<section id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 序</h2>
<div class="outline-text-2" id="text-1">
<p>
步骤：
</p>
<ol class="org-ol">
<li>创建 Gradle 项目
</li>
<li>增加 jar 包支持：
<pre class="example">
org.apache.struts:struts2-core:2.5.11
</pre>
</li>
<li>配置 web.xml，让struts 拦截并处理所有来自客户端的请求
<div class="org-src-container">

<pre class="src src-xml"><span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">filter</span><span class="org-nxml-tag-delimiter">&gt;</span>
  <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">filter-name</span><span class="org-nxml-tag-delimiter">&gt;</span><span class="org-nxml-text">abc</span><span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">filter-name</span><span class="org-nxml-tag-delimiter">&gt;</span>
  <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">filter-class</span><span class="org-nxml-tag-delimiter">&gt;</span><span class="org-nxml-text">org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter</span><span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">filter-class</span><span class="org-nxml-tag-delimiter">&gt;</span>
<span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">filter</span><span class="org-nxml-tag-delimiter">&gt;</span>
<span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">filter-mapping</span><span class="org-nxml-tag-delimiter">&gt;</span>
  <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">filter-name</span><span class="org-nxml-tag-delimiter">&gt;</span><span class="org-nxml-text">abc</span><span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">filter-name</span><span class="org-nxml-tag-delimiter">&gt;</span>
  <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">url-pattern</span><span class="org-nxml-tag-delimiter">&gt;</span><span class="org-nxml-text">/*</span><span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">url-pattern</span><span class="org-nxml-tag-delimiter">&gt;</span>
<span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">filter-mapping</span><span class="org-nxml-tag-delimiter">&gt;</span>
</pre>
</div>
</li>
<li>classpath 下添加 struts.xml 文件，定义变量，定义包，定义 Action
<div class="org-src-container">

<pre class="src src-xml"><span class="org-nxml-processing-instruction-delimiter">&lt;?</span><span class="org-nxml-processing-instruction-target">xml</span> <span class="org-nxml-attribute-local-name">version</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">1.0</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-attribute-local-name">encoding</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">UTF-8</span><span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-processing-instruction-delimiter">?&gt;</span>
<span class="org-nxml-markup-declaration-delimiter">&lt;!</span><span class="org-nxml-prolog-keyword">DOCTYPE</span> struts <span class="org-nxml-prolog-keyword"><span class="org-nxml-prolog-keyword">PUBLIC</span></span> <span class="org-nxml-prolog-literal-delimiter">"</span><span class="org-nxml-prolog-literal-content">-//Apache Software Foundation//DTD Struts Configuration 2.5//EN</span><span class="org-nxml-prolog-literal-delimiter">"</span> <span class="org-nxml-prolog-literal-delimiter">"</span><span class="org-nxml-prolog-literal-content">http://struts.apache.org/dtds/struts-2.5.dtd</span><span class="org-nxml-prolog-literal-delimiter">"</span><span class="org-nxml-markup-declaration-delimiter">&gt;</span>
<span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">struts</span><span class="org-nxml-tag-delimiter">&gt;</span>
    <span class="org-nxml-comment-delimiter">&lt;!--</span><span class="org-nxml-comment-content"> &#24320;&#21551;&#24320;&#21457;&#27169;&#24335;&#65292;&#36825;&#26679;&#21487;&#20197;&#22312; jsp &#20013;&#20351;&#29992; s:debug &#26597;&#30475;&#21464;&#37327; </span><span class="org-nxml-comment-delimiter">--&gt;</span>
    <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">constant</span> <span class="org-nxml-attribute-local-name">name</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">struts.devMode</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-attribute-local-name">value</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">true</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-tag-slash">/</span><span class="org-nxml-tag-delimiter">&gt;</span>
    <span class="org-nxml-comment-delimiter">&lt;!--</span><span class="org-nxml-comment-content">&#40664;&#35748;&#30340;&#25193;&#23637;&#21517;&#20026; .action&#65292;&#20294;&#26159;&#25105;&#20204;&#21487;&#20197;&#23450;&#21046;&#23427;</span><span class="org-nxml-comment-delimiter">--&gt;</span>
    <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">constant</span> <span class="org-nxml-attribute-local-name">name</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">struts.action.extension</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-attribute-local-name">value</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">html</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-tag-slash">/</span><span class="org-nxml-tag-delimiter">&gt;</span>

    <span class="org-nxml-comment-delimiter">&lt;!--</span><span class="org-nxml-comment-content"> &#29992; package &#26469;&#21010;&#20998;&#21508;&#20010;&#27169;&#22359;&#65292;&#20027;&#35201;&#29992;&#26469;&#26041;&#20415;&#32500;&#25252;&#31649;&#29702; </span><span class="org-nxml-comment-delimiter">--&gt;</span>
    <span class="org-nxml-comment-delimiter">&lt;!--</span><span class="org-nxml-comment-content"> &#38656;&#35201;&#32487;&#25215;&#40664;&#35748;&#30340; struts-default, &#36825;&#26159; struts &#20869;&#32622;&#23450;&#20041;&#30340;&#19968;&#20010; package, &#37324;&#38754;&#39044;&#20808;&#23450;&#20041;&#20102;&#24456;&#22810;&#19996;&#35199; </span><span class="org-nxml-comment-delimiter">--&gt;</span>
    <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">package</span> <span class="org-nxml-attribute-local-name">name</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">default</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-attribute-local-name">namespace</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">/</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-attribute-local-name">extends</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">struts-default</span><span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-tag-delimiter">&gt;</span>
        <span class="org-nxml-comment-delimiter">&lt;!--</span>
<span class="org-nxml-comment-content">          url: /emplist</span>
<span class="org-nxml-comment-content">          &#30001;&#21738;&#20010;&#31867; &#30340;&#21738;&#20010;&#26041;&#27861; &#21435;&#22788;&#29702;&#65292;</span>
<span class="org-nxml-comment-content">          &#22914;&#26524;&#35831;&#27714;&#25104;&#21151;&#65292;&#24212;&#35813;&#30001;&#21738;&#20010;JSP&#21435;&#28210;&#26579;&#39029;&#38754;</span>
<span class="org-nxml-comment-content">              &#22914;&#26524; result &#19981;&#24102; name&#65292;&#40664;&#35748;&#25351;&#30340;&#26159; success</span>
<span class="org-nxml-comment-content">              &#22914;&#26524;&#35831;&#27714;&#20013;&#26377;&#39564;&#35777;&#38169;&#35823;&#65292;&#40664;&#35748;&#36820;&#22238;&#21517;&#23383;&#20026; input &#30340; result</span>
<span class="org-nxml-comment-content">        </span><span class="org-nxml-comment-delimiter">--&gt;</span>
        <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">action</span> <span class="org-nxml-attribute-local-name">name</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">emplist</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-attribute-local-name">class</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">com.nf.empst.action.EmpAction</span><span class="org-nxml-attribute-value-delimiter">"</span> <span class="org-nxml-attribute-local-name">method</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">emplist</span><span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-tag-delimiter">&gt;</span>
            <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">result</span><span class="org-nxml-tag-delimiter">&gt;</span><span class="org-nxml-text">/view/emplist.jsp</span><span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">result</span><span class="org-nxml-tag-delimiter">&gt;</span>
            <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-element-local-name">result</span> <span class="org-nxml-attribute-local-name">name</span>=<span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-attribute-value">input</span><span class="org-nxml-attribute-value-delimiter">"</span><span class="org-nxml-tag-delimiter">&gt;</span><span class="org-nxml-text">/view/emplist.jsp</span><span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">result</span><span class="org-nxml-tag-delimiter">&gt;</span>
        <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">action</span><span class="org-nxml-tag-delimiter">&gt;</span>        
    <span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">package</span><span class="org-nxml-tag-delimiter">&gt;</span>
<span class="org-nxml-tag-delimiter">&lt;</span><span class="org-nxml-tag-slash">/</span><span class="org-nxml-element-local-name">struts</span><span class="org-nxml-tag-delimiter">&gt;</span>
</pre>
</div>
</li>
<li>实现 <code>Action#emplist</code> 方法, 用来响应 <code>/emplist.action</code> 的请求
<div class="org-src-container">

<pre class="src src-java"><span class="org-comment-delimiter">// </span><span class="org-comment">*&#26368;&#22909;*&#35201;&#32487;&#25215; ActionSupport&#65292;&#36825;&#20010;&#31867;&#23450;&#20041;&#20102;&#19968;&#20123;&#24120;&#29992;&#21464;&#37327;&#65292;&#24182;&#19988;&#31616;&#21333;&#23454;&#29616;&#20102;&#19968;&#20123;&#24120;&#29992;&#25509;&#21475;</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">&#23588;&#20854;&#23427;&#20026;&#25968;&#25454;&#39564;&#35777;&#21644;&#22269;&#38469;&#21270;&#25552;&#20379;&#20102;&#19968;&#20123;&#25903;&#25345;</span>
<span class="org-keyword">public</span> <span class="org-keyword">class</span> <span class="org-type">EmpAction</span> <span class="org-keyword">extends</span> <span class="org-type">ActionSupport</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">&#21464;&#37327;&#23450;&#20041;</span>
    <span class="org-comment-delimiter">//   </span><span class="org-comment">1. &#21487;&#20197;&#29992;&#26469;&#25509;&#25910;&#26469;&#33258;&#35831;&#27714;&#20013;&#30340; parameter</span>
    <span class="org-comment-delimiter">//   </span><span class="org-comment">2. &#20063;&#21487;&#20197;&#29992;&#26469;&#20445;&#23384;&#29992;&#26469;&#22312; JSP &#39029;&#38754;&#28210;&#26579;&#30340;&#25968;&#25454;</span>
    <span class="org-keyword">private</span> <span class="org-type">String</span> <span class="org-variable-name">name</span>;
    <span class="org-keyword">private</span> <span class="org-type">List</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Emp</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">emps</span> = <span class="org-keyword">new</span> <span class="org-type">ArrayList</span><span class="org-rainbow-delimiters-depth-2">&lt;&gt;()</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">&#26412;&#31867;&#20013;&#25152;&#26377; action &#26041;&#27861;&#20844;&#26377;&#30340;&#39564;&#35777;&#26041;&#27861;</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">&#22914;&#26524;&#22312;&#36825;&#20010;&#29615;&#33410;&#20986;&#38169;&#65292;&#37027;&#20040;&#30456;&#24212; action &#26041;&#27861;&#23558;&#19981;&#20250;&#25191;&#34892;</span>
    <span class="org-keyword">public</span> <span class="org-type">void</span> <span class="org-function-name">validate</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>name == <span class="org-constant">null</span> || name.isEmpty<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">{</span>
            addFieldError<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"name"</span>, <span class="org-string">"&#22995;&#21517;&#20986;&#38169;!"</span><span class="org-rainbow-delimiters-depth-4">)</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">&#22686;&#21152;&#38169;&#35823;&#30340;&#26041;&#27861;&#12290;&#38169;&#35823;&#26377; fieldError/actionError &#31561;&#31867;&#22411;&#12290;</span>
        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">&#26684;&#24335;&#20026; validateXXX, &#21517;&#23383;&#20026; XXX &#30340; action &#26041;&#27861;&#30340;&#29420;&#26377;&#39564;&#35777;&#26041;&#27861;</span>
    <span class="org-keyword">public</span> <span class="org-type">void</span> <span class="org-function-name">validateEmplist</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">&#32487;&#32493;&#22686;&#21152;&#20854;&#20182;&#39564;&#35777;</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">...</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>hasErrors<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">&#20135;&#29983;&#20102;&#26576;&#20123;&#39564;&#35777;&#38169;&#35823;&#65292;&#23558;&#19981;&#20250;&#32487;&#32493;&#25191;&#34892; action &#26041;&#27861;&#65292;&#32780;&#26159;&#36716;&#21040; input &#39029;&#38754;</span>
        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">action &#26041;&#27861;&#65292;&#23545;&#24212; &#8216;/emplist.action&#8217; &#35831;&#27714;</span>
    <span class="org-keyword">public</span> <span class="org-type">String</span> <span class="org-function-name">emplist</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        emps = <span class="org-keyword">new</span> <span class="org-type">EmpDAO</span><span class="org-rainbow-delimiters-depth-3">()</span>.getAll<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-keyword">return</span> SUCCESS;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>
</li>
<li>实现视图层(view)，即实现页面渲染，即 jsp:
<div class="org-src-container">

<pre class="src src-html">&lt;<span class="org-function-name">head</span>&gt;
  <span class="org-comment-delimiter">&lt;!-- </span><span class="org-comment">&#29992;&#26469;&#25552;&#20379;&#19968;&#20123;&#20869;&#32622;&#30340;&#26679;&#24335; </span><span class="org-comment-delimiter">--&gt;</span>
  &lt;<span class="org-sgml-namespace">s</span>:<span class="org-function-name">head</span> /&gt;
&lt;/<span class="org-function-name">head</span>&gt;

&lt;<span class="org-function-name">ul</span>&gt;
  <span class="org-comment-delimiter">&lt;!-- </span><span class="org-comment">&#24490;&#29615;&#36845;&#20195;&#26174;&#31034;&#25968;&#25454; </span><span class="org-comment-delimiter">--&gt;</span>
  &lt;<span class="org-sgml-namespace">s</span>:<span class="org-function-name">iterator</span> <span class="org-variable-name">value</span>=<span class="org-string">"emps"</span> <span class="org-variable-name">var</span>=<span class="org-string">"e"</span> <span class="org-variable-name">status</span>=<span class="org-string">"s"</span>&gt;
    &lt;<span class="org-function-name">li</span>&gt;${s.index} / ${e.name} / ${e.salary}&gt; &lt;/<span class="org-function-name">li</span>&gt;
  &lt;/<span class="org-sgml-namespace">s</span>:<span class="org-function-name">iterator</span>&gt;
&lt;/<span class="org-function-name">ul</span>&gt;

<span class="org-comment-delimiter">&lt;!-- </span><span class="org-comment">&#21033;&#29992;&#26631;&#31614;&#24555;&#36895;&#29983;&#25104;&#26684;&#24335;&#21270;&#30340;&#34920;&#21333; </span><span class="org-comment-delimiter">--&gt;</span>
&lt;<span class="org-sgml-namespace">s</span>:<span class="org-function-name">form</span> <span class="org-variable-name">action</span>="empsave"&gt;
  &lt;<span class="org-sgml-namespace">s</span>:<span class="org-function-name">textfield</span> <span class="org-variable-name">name</span>="ename" /&gt;
  &lt;<span class="org-sgml-namespace">s</span>:<span class="org-function-name">select</span> <span class="org-variable-name">name</span>="deptno" <span class="org-variable-name">list</span>="depts" /&gt;
  &lt;<span class="org-sgml-namespace">s</span>:<span class="org-function-name">submit</span> <span class="org-variable-name">value</span>="s" /&gt;
&lt;/<span class="org-sgml-namespace">s</span>:<span class="org-function-name">form</span>&gt;

&lt;<span class="org-function-name">footer</span>&gt;
  <span class="org-comment-delimiter">&lt;!-- </span><span class="org-comment">&#29992;&#26469;&#26174;&#31034;&#21487;&#29992;&#25968;&#25454; </span><span class="org-comment-delimiter">--&gt;</span>
  &lt;<span class="org-sgml-namespace">s</span>:<span class="org-function-name">debug</span> /&gt;
&lt;/<span class="org-function-name">footer</span>&gt;
</pre>
</div>
</li>
</ol>
</div>
</section>
</div>
<div id="postamble" class="status">
<p class="author">Author: imfine</p>
<p class="date">Created: 2017-10-20 Fri 11:11</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.2.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation">Go ahead, never stop.</p>
</div>
</body>
</html>
